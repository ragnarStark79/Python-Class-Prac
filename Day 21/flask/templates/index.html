<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Control // Cream</title>

    <!-- Fonts: Space Grotesk (Tech/Future) & Inter (UI) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Space+Grotesk:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Bootstrap Grid Only (for layout structure) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap-grid.min.css" rel="stylesheet">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>

    <div class="app-container">

        <!-- Header -->
        <header class="header-section">
            <h1 class="header-title">Task Control</h1>
            <p class="header-subtitle">System // V.02 Cream</p>
        </header>

        <!-- Control Panel (Form) -->
        <section class="control-panel">
            <form method="POST" enctype="multipart/form-data">
                {{ form.hidden_tag() }}

                <!-- Task Input -->
                <div class="input-group">
                    <label class="input-label">Mission Directive</label>
                    {{ form.task(class="", placeholder="Enter new task...") }}
                    {% for error in form.task.errors %}
                    <div style="color:red; font-size: 0.8rem; margin-top: 5px;">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Image Input -->
                <div class="input-group">
                    <label class="input-label">Visual Asset</label>
                    {{ form.image(id="file-input") }}
                    {% for error in form.image.errors %}
                    <div style="color:red; font-size: 0.8rem; margin-top: 5px;">{{ error }}</div>
                    {% endfor %}
                </div>

                <!-- Live Preview Zone -->
                <div id="preview-box" class="preview-container">
                    <!-- Image will be injected here via JS -->
                    <img id="preview-img" class="preview-img" src="" alt="Preview">
                    <span class="preview-label">Ready to Upload</span>
                </div>

                <!-- Submit -->
                <div style="margin-top: 1.5rem;">
                    {{ form.submit(class="") }}
                </div>
            </form>
        </section>

        <hr style="border: 0; border-top: 1px solid var(--border-color); margin-bottom: 3rem;">

        <!-- Task Grid -->
        <div class="task-grid">
            {% for todo in todos %}
            <article class="task-card">
                {% if todo.image %}
                <div class="card-image-wrap">
                    <img src="{{ url_for('static', filename='uploads/' + todo.image) }}" class="card-img"
                        alt="Task Image">
                </div>
                {% endif %}

                <div class="card-content">
                    <p class="task-text">{{ todo.task }}</p>
                    <a href="{{ url_for('delete', id=todo.id) }}" class="btn-delete">Delete Unit</a>
                </div>
            </article>
            {% else %}
            <div class="empty-state">
                <h3>No Active Tasks</h3>
                <p>System is clear. Awaiting input.</p>
            </div>
            {% endfor %}
        </div>

    </div>

    <!-- Full Screen Image Modal -->
    <div id="image-modal" class="image-modal">
        <button class="close-modal">&times;</button>
        <img id="modal-img" class="modal-content" src="" alt="Full View">
    </div>

    <!-- Custom Scripts -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>

</html>